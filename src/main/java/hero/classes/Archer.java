package hero.classes;

import hero.Hero;
import item.weapon.ShortBow;
import lombok.Getter;
import spec.HeroClass;

import java.util.List;

import static tools.Dice.randomInt;

/**
 * Класс, представляющий героя класса "Лучник".
 * Наследует общие характеристики и поведение от класса {@link Hero}.
 */
@Getter
public class Archer extends Hero {

    /**
     * Класс героя — лучник.
     */
    private final HeroClass heroClass = HeroClass.ARCHER;

    /**
     * Классовые характеристики
     */
    private static final int INTELLIGENCE = 1;
    private static final int STRENGTH = 3;
    private static final int DEXTERITY = 5;

    private static final double CRIT_CHANCE = 0.2;

    /**
     * Создаёт нового лучника с заданным именем и базовыми характеристиками.
     *
     * @param name Имя лучника
     */
    public Archer(String name) {
        super();

        setName(name);

        // Установка характеристик
        setIntelligence(INTELLIGENCE);
        setStrength(STRENGTH);
        setDexterity(DEXTERITY);

        setCritChance(CRIT_CHANCE);

        getInventory().put(new ShortBow());
        getHealth().fillUp();
    }

    public String getPainMessage() {
        int index = randomInt(ARCHER_PAIN_MESSAGES.size());
        return String.format(ARCHER_PAIN_MESSAGES.get(index), getName());
    }
    private static final List<String> ARCHER_PAIN_MESSAGES = List.of(
            "%s зашипел, схватившись за рану, но не отпустил лук!",
            "%s пошатнулся от удара, но быстро вернулся в строй!",
            "%s скривился от боли, но его пальцы всё ещё крепко сжимают тетиву!",
            "%s стиснул зубы, чувствуя жгучую боль в боку!",
            "%s едва не уронил стрелу, но собрался с силами!"
    );

    public String getShieldAbsorbMessage() {
        int index = randomInt(ARCHER_SHIELD_ABSORB_MESSAGES.size());
        return String.format(ARCHER_SHIELD_ABSORB_MESSAGES.get(index), getName());
    }
    private static final List<String> ARCHER_SHIELD_ABSORB_MESSAGES = List.of(
            "%s укрылся за щитом, не получив ни царапины!",
            "%s выставил щит в последний момент и выдохнул – атака погашена!",
            "%s спрятался за защитой, не давая врагу ни шанса пробить его!",
            "%s почувствовал удар, но защита выдержала, оставив его невредимым!",
            "%s прижал щит к себе, полностью поглощая удар!"
    );

    public String getBlockedMessage() {
        int index = randomInt(ARCHER_BLOCKED_MESSAGES.size());
        return String.format(ARCHER_BLOCKED_MESSAGES.get(index), getName());
    }
    private static final List<String> ARCHER_BLOCKED_MESSAGES = List.of(
            "%s с лёгким движением отбил удар своим луком!",
            "%s парировал атаку, отведя оружие противника в сторону!",
            "%s резко развернулся, выставив щит, и атака ушла в сторону!",
            "%s вовремя среагировал и заблокировал удар!",
            "%s легко ушёл в сторону и отразил удар кончиком стрелы!"
    );

    /**
     * Получает случайное сообщение при атаке.
     *
     * @return Строка с текстом атаки, включающая имя персонажа.
     */
    public String getAttackMessage() {
        int index = randomInt(ARCHER_ATTACK_MESSAGES.size());
        return String.format(ARCHER_ATTACK_MESSAGES.get(index), getName());
    }
    private static final List<String> ARCHER_ATTACK_MESSAGES = List.of(
            "%s плавно натянул тетиву, словно играя на струнах судьбы, и выпустил стрелу, летящую в самое сердце цели!",
            "%s прищурился, словно оценивая вечерний закат, а затем молниеносно выстрелил — стрела ушла в полёт!",
            "%s улыбнулся краем губ, прицелился и, как истинный мастер, поразил цель без малейшего колебания.",
            "%s отступил на шаг назад, вдохнул полной грудью, а затем его стрела нашла свою судьбу!",
            "%s подкинул стрелу в воздух, поймал её на лету и ловко выпустил, не давая врагу и секунды передышки.",
            "%s поднял голову к небу, будто обращаясь к звёздам, и с той же уверенностью отправил свою стрелу в путь.",
            "%s со вздохом философа выстрелил — без суеты, без сомнений, словно сам ветер направлял его руку.",
            "%s развернулся, как в танце, и с безупречной грацией выпустил стрелу, оставляя в воздухе лишь её свист.",
            "%s отошёл на шаг, шутливо поклонился и тут же отправил стрелу, что летела со смертельной точностью.",
            "%s резко дёрнул рукой — тетива запела, и стрела сорвалась с места, как охотничий сокол.",
            "%s шепнул древнее заклинание и выстрелил, отпуская стрелу с уверенностью, что её цель уже предрешена.",
            "%s поправил плащ, прокрутил стрелу в пальцах и, играючи, поразил противника.",
            "%s резко вскинул лук, и два быстрых выстрела слились в одно мгновение — один за другим!",
            "%s прицелился, вдохнул, выдохнул… выстрел — будто само время замедлилось ради этой идеальной атаки.",
            "%s с лёгкой ухмылкой выпустил стрелу — без спешки, без нервов, словно это всего лишь дружеское состязание.",
            "%s, перекатившись в сторону, встал на одно колено и тут же отправил свою стрелу в путешествие.",
            "%s словно чувствовал ветер, его стрела летела идеально, не зная преград.",
            "%s посмотрел в глаза противнику, ухмыльнулся и выпустил стрелу — быстро, точно, безупречно.",
            "%s качнул головой, будто жалея противника, и с безжалостной точностью отправил стрелу в полёт.",
            "%s снял капюшон, стряхнул с лука невидимую пылинку, и с изящной небрежностью выстрелил.",
            "%s в прыжке натянул тетиву, а затем, повиснув в воздухе на мгновение, выстрелил — враг не успел даже моргнуть.",
            "%s, будто разговаривая с луком, прошептал: 'Ну, давай покажем им…' — и стрела полетела, оставляя за собой эхо ветра.",
            "%s закинул лук за спину, но вдруг резко выхватил стрелу и выстрелил, не давая противнику шанса среагировать.",
            "%s хитро прищурился, оглядел поле битвы и с полной уверенностью отправил стрелу прямо в цель.",
            "%s встал на край утёса, ветер трепал его волосы… Он улыбнулся, выстрелил — и природа сама повела стрелу к её предназначению.",
            "%s прокрутил лук в руке, оценивая баланс, и пустил стрелу, не дожидаясь момента — он знал, что попадёт.",
            "%s прошептал: 'Эта стрела несёт правосудие', и тетива ответила ему мелодичным звуком выстрела.",
            "%s прицелился, закрыл один глаз, прошептал: 'До свидания' — и стрела нашла свою жертву.",
            "%s пустил стрелу, как если бы просто отправил письмо давнему другу — безошибочно, без промаха, с неизбежной точностью.",
            "%s прицелился и сказал: 'Ну что ж, попробуем с закрытыми глазами?' — и, не глядя, попал в точку."
    );

    /**
     * Получает случайное сообщение при промахе.
     *
     * @return Строка с текстом промаха, включающая имя персонажа.
     */
    public String getMissedMessage() {
        int index = randomInt(ARCHER_MISSED_MESSAGES.size());
        return String.format(ARCHER_MISSED_MESSAGES.get(index), getName());
    }
    private static final List<String> ARCHER_MISSED_MESSAGES = List.of(
            "%s отпустил тетиву, но стрела решила отправиться в путешествие!",
            "%s хитро прищурился – ветер сегодня явно не на его стороне.",
            "%s кивнул – судьба дала врагу ещё один вздох.",
            "%s усмехнулся – не попал? Значит, бой будет интереснее!",
            "%s выпустил стрелу, но небо решило, что она достойна лучшей цели.",
            "%s поклонился – враг достоин уважения, раз увернулся!",
            "%s постучал по луку – может, оружие хочет сказать что-то?",
            "%s отпустил вторую стрелу следом – пусть догоняет первую!",
            "%s покрутил стрелу в руке – чувствуется, что сегодня день испытаний.",
            "%s поднял глаза к звёздам – там, наверное, его стрела уже светится.",
            "%s кивнул сам себе – не каждый день можно наблюдать такие уклонения!",
            "%s провёл рукой по луке – чувствуется, что стрелы жаждут мишени.",
            "%s усмехнулся – в таком бою главное не попадание, а стиль!",
            "%s сделал шаг назад – враг заслужил мгновение триумфа перед поражением.",
            "%s быстро вытащил новую стрелу – теперь всё серьёзно!",
            "%s чуть повел плечом – растяжка тетивы требует идеального баланса.",
            "%s прикрыл глаза – следующее попадание будет по воле судьбы.",
            "%s покачал головой – вот ведь жаль, а он был так близок!",
            "%s снова прицелился – теперь точно в цель!",
            "%s усмехнулся – значит, бой будет дольше, а значит, веселее!"
    );

    /**
     * Получает случайное сообщение при перезарядке.
     *
     * @return Строка с текстом перезарядки, включающая имя персонажа.
     */
    public String getReloadMessage() {
        int index = randomInt(ARCHER_RELOAD_MESSAGES.size());
        return String.format(ARCHER_RELOAD_MESSAGES.get(index), getName());
    }
    private static final List<String> ARCHER_RELOAD_MESSAGES = List.of(
            "%s натягивает тетиву, слушая её лёгкий звон.",
            "%s провёл пальцем по оперению стрелы, выбирая идеальную.",
            "%s медленно вдыхает, фокусируя взгляд на будущей цели.",
            "%s прикрыл один глаз – идеальный выстрел требует концентрации.",
            "%s выпрямил спину – истинный стрелок всегда держит осанку.",
            "%s провёл ладонью по луку – он и оружие – одно целое.",
            "%s резко дёрнул тетиву – звук её натяжения как песня победы.",
            "%s посмотрел на ветер – даже он должен подчиняться его стрелам!",
            "%s нащупал в колчане самую острую стрелу – её час настал!",
            "%s проверил, надёжно ли крепится стрелка на тетиве.",
            "%s улыбнулся – хорошему лучнику не нужно торопиться.",
            "%s чуть покачал головой – ещё мгновение, и выстрел будет точен!",
            "%s поднёс стрелу к губам – ритуал удачи перед метким выстрелом.",
            "%s перекатился в сторону, заняв лучшую позицию для следующего выстрела.",
            "%s одним движением выхватил стрелу – сейчас враг об этом пожалеет!",
            "%s оценил расстояние – ветер, угол, сила натяжения – всё учтено!",
            "%s медленно и плавно потянул тетиву – точность превыше всего.",
            "%s слегка улыбнулся – стрелы никогда не спешат, они ждут момента.",
            "%s посчитал про себя – три, два, один… почти готов!",
            "%s едва заметно изменил угол лука – идеальный выстрел близко."
    );
}
